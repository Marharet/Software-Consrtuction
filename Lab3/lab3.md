<h3 style="text-align: center; line-height: 4vh;">
Міністерство Освіти і Науки України<br>
Тернопільський національний технічний університет імені Івана Пулюя<br>
Факультет комп’ютерно-інформаційних систем та програмної інженерії</h3>

<br>
<h3 style="text-align: right;">
<i>Кафедра "Програмної інженерії"</i></h3>

<br><br><br><br>

<h3 style="text-align: center; line-height: 4vh;">
ЗВІТ<br>
з лабораторної роботи №3<br>
з навчальної дисципліни "Конструювання програмного забезпечення"<br>
Тема: "Написання інтерпретатора мови програмування"</h3>

<br><br><br><br>

<h3 style="text-align: right; line-height: 4vh;">
Підготувала:<br>
студентка групи СП-32<br>
Прачук Маргарита Вікторівна</h3>

<br><br><br>
<h3 style="text-align: center;">Тернопіль 2024</h3>
<br><br><br>

## Мета
Набути навичок з розробки інтерпретаторів та компліяторів мов програмування.

## Опис ПЗ
Відповідно до завдання було виконані наступні завдання та вимоги:
- реалізувати інтерпретатор мови SmallBasic з використанням принципів написання досконалого коду;
- до запропонованої версії інтепретатора додати нові ключові слова;
- реалізувати можливість генерації виконуваного файлу (компіляції коду).

## Обмеження
Програма має такі обмеження:
- програма не реалізовує всі ключові слова, які наявні в оригінальному компіляторі Visual Basic.
- розмір файлу обмежується розміром 10000 байт.
- програма не підтримує ООП.
- програма не підтримує роботу кількох файлів одночасно.

## Приклад роботи програми
Вхідні дані, файл `test.bas`
```
PRINT "This program demonstrates all features."

FOR X = 1 TO 100
Y = 3
IF X = 10 OR X = 12 THEN PRINT X
IF X = 10 AND Y = 3 THEN PRINT Y
IF X = 10 AND Y = 2 THEN PRINT Y

NEXT
```
Результат виконання:
```
Enter path to the file: path_to_file\test.bas
File path entered: path_to_file\test.bas
SBasicImplementation instance created successfully.
This program demonstrates all features.
10.0
3.0
12.0
SBasicImplementation run method executed successfully.
```

## Основні можливості ПЗ
- проект працює з такими ключовими словами: `UNKNCOM`, `PRINT`, `INPUT`, `IF`, `AND`, `OR`, `THEN`, `FOR`, 
`NEXT`, `TO`, `GOTO`, `GOSUB`, `RETURN`, `END`, `EOL`. Їх описано в enum структурі під назвою `InsidedInterp`.
- програма компілює файли з кодом на мові програмування Visual Basic.
- програма приймає для зчитування різні текстові формати файлів, такі як `.txt`, `.bas` та подібні.
- програма не вимагає відсутність порожніх рядочків файлу.
- система обробляє дійсні числа.
- інтерпретатор розпізнає змінні.

## Імплементація
Код програми знаходиться в папці [src](/src). Виконання проводилось в середовищі **JetBrains IntelliJ IDEA**, з використаням **Gradle**. Для корректної роботи програми необхідна 21 версія JDK.

Система складається з трьох модулів: 
- `Errors` - модуль обробки помилок.
- `Parser` - модуль розбору виразів та ключових слів.
- `SBasic` - модуль інтерпретатора мови програмування Visual Basic.

Головним модулем програми є `SBasic`, основним файлом цього модуля є `Interpreter.java`. `Interpreter.java` використовує 
модулі `Parser` і `Errors`. Точкою входу в модуль для розбору виразів та ключових слів слугує метод `scanLabels()`. Результатом
виконання цього методу є розбір файлу на токени. Після цього викликається метод `sbInterp()`, який на основі записаних
раніше токенів "компілює" наданий код. При виникненні помилки модуль `Errors` оброблює їх та виводить відповідні повідомлення в консоль.

## Інструкція щодо використання
При запуску програми відкрисається консоль із повідомленням `"Enter path to the file: "` та чекатиме на 
ввід користувачем шлях до файлу з кодом. Після цього при закінченні обробки інформації в консоль буде виведено 
результат виконання наданого коду.

## Завдання на захист
_Реалізувати GitHub actions для автоматичного запуску тестів у вітці цього issue та main._

Мною було створено workflow `Lab3.yml` для Git Actions.

Цей GitHub Actions workflow призначений для автоматичного збирання та тестування Java-проєкту за допомогою Gradle при кожному push або pull request, що стосуються файлів у папці Lab3/VBasicCompiler, для гілок main та lab-3-marharyta-prachuk. Воркфлоу складається з двох jobs: build та test. Jod build виконується на останній версії Ubuntu, включає кроки для клонування репозиторію, налаштування JDK 21, перевірки наявності та надання прав на виконання файлу gradlew, і збирання проєкту без запуску тестів. Job test, яка залежить від успішного виконання job build, також виконується на останній версії Ubuntu і включає аналогічні кроки для клонування репозиторію, налаштування JDK 21, перевірки наявності та надання прав на виконання файлу gradlew, після чого запускаються тести за допомогою Gradle.


Файли із дерикторії `Output` були отримані шляхом імітації роботи алгоритму Simple Basic.

